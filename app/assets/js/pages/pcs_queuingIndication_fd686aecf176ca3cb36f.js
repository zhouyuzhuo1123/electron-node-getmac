webpackJsonp([8],{636:function(t,e,n){"use strict";(function(e,r,o){var a=n(35),u=n(658),i=n(34),d=n(78),c={configCodes:[],rowNum:10,stationCode:"",title:""},s={productNumDetail:"--",carDescription:"--",remainingQuantity:"--",productIdDetail:"--"},p={datatableApi:void 0,hasHistory:!1,pages:void 0,page:void 0,$page:void 0,init:function(){var t=this;a.getSysModuleConfig("PCS","ONLINE_INDICATION").done(function(e){i.proConfig(e,function(e){c=e,t.userCode=a.getUserProfile().userCode,t.btnEvent(),t._getDataAndRenderScreen()})})},btnEvent:function(){var t=this;e("#queueIndRender").on("click",".confirmBtn",function(){i.service("GMES-CLIENT-PCS0003",{stationCode:c.stationCode,productNum:e(".productNum").attr("productnum"),productTrackNum:"",productionSeqNum:e(".productId").attr("productid"),createUser:t.userCode},"正在确认").done(function(e){"0"===e.returnCode?(r.alert({type:"1",text:"产品分装上线记录成功"}),t._getDataAndRenderScreen()):r.alert({text:"产品分装上线记录失败"})})}),e(".more-history").click(function(){t.getHistory()}),i.enterEvent(function(){e(".confirmBtn").trigger("click")})},_getDataAndRenderScreen:function(){i.service("GMES-CLIENT-PCS0011",{stationCode:c.stationCode,rowNum:c.rowNum||0,num:c.rowNum||0,pageNum:0,getNum:3,stNum:2},"正在加载中").done(function(t){var e=null;if("0"===t.returnCode){var n=t.data.productionQueues;0===n.length&&r.alert({type:"1",text:"当前站点无数据"}),d.forEach(n,function(t,e){n[e]=i.processData(c,n[e])}),e=n[0]||{},e.productionQueues=[n[1]||s,n[2]||s];var o=c.thresholdValue||5;parseInt(e.remainingQuantity)<=parseInt(o)&&(e.warnShineFlag=!0),i.tplManager("queueIndTpl",e,"queueIndRender")}})},sure:function(){i.hotkeysBind("keydown","return",function(){e(".confirmBtn",this.$page).click()})},setPopup:function(){i.setPublicPopup("上件指示历史记录",'<div class="table-panel">\n           <table class="table-bordered table-striped w100p">\n               <thead>\n                   <th>产品顺序</th>\n                   <th>站点编号</th>\n                   <th>生产管理号</th>\n                   <th>产品跟踪号</th>\n                   <th>物料描述</th>\n                   <th>创建时间</th>\n               </thead>\n           </table>\n       </div>')},getHistory:function(){var t=this;this.setPopup(),this.datatableApi=i.dataTable(e(".popup-public .table-panel table"),{ordering:!1,dom:"<'row'<'col-50'f>> <'row'<'col-100'tr>> <'row'<'col-50'p>>",scrollX:!0,scrollY:!0,destroy:!0,pageLength:5,order:[],ajax:{serviceCode:"GMES-CLIENT-PCS0007",param:function(){return{serviceCode:"GMES-CLIENT-PCS0007",siteCode:o.siteCode,stationCode:c.stationCode,userCode:t.userCode,languageCode:"zh",pageNum:1,productNum:"",productTrackNum:"",createDateTimeSt:"",createDateTimeEd:""}}},createdRow:function(t,n){1!=n.statusEcode&&e(t).addClass("error")},columns:[{data:"id",render:function(t,e,n,r){return r.settings._iDisplayStart+r.row+1}},{data:"stationCode",name:"stationCode"},{data:"productionSeqNum",name:"productionSeqNum"},{data:"productNum",name:"productNum"},{data:"materialText",name:"materialText"},{data:"createDateTime",name:"createDateTime",render:function(e){return t.hasHistory=!0,u.three(e)}}]})}};t.exports=p}).call(e,n(4),n(36),n(77))},658:function(t,e,n){"use strict";function r(t){var e=new Date;t&&(e=new Date(t));var n=new Object;return n.year=e.getFullYear(),n.month=o(e.getMonth()+1),n.day=o(e.getDate()),n.hour=o(e.getHours()),n.minute=o(e.getMinutes()),n.second=o(e.getSeconds()),n}function o(t){return t.toString().length<2?"0"+t:t}function a(t){var e=r(t);return e.year+"-"+e.month+"-"+e.day}function u(t){var e=r(t);return e.year+"-"+e.month+"-"+e.day+" "+e.hour+"h"}function i(t){var e=r(t);return e.year+"-"+e.month+"-"+e.day+" "+e.hour+":"+e.minute+":"+e.second}function d(t){var e=r(t);return e.year+"-"+e.month+"-"+e.day+"T"+e.hour+":"+e.minute}t.exports={one:a,two:u,three:i,format:d}}});
//# sourceMappingURL=pcs_queuingIndication_fd686aecf176ca3cb36f.js.map