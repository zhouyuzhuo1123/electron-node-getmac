{"version":3,"sources":["webpack:///assets/js/pages/pcs_queuingDoubleIndication_ba49ca072141a3a53045.js","webpack:///./src/js/pages/pcs/queuingDoubleIndication.js"],"names":["webpackJsonp","635","module","exports","__webpack_require__","$","notie","_stringify","_stringify2","obj","__esModule","default","kit","security","util","options","moduleConfig","configCodes","rowNum","stationCode","title","reverse","config","nowPage","ifReverse","resetPage","canSurePage","pageSize","siteCode","getSiteCode","StationCode","urlDetail","urlHistory","queuingDoubleIndicationCtrl","queueType","sureDataCont","productNumCont","productionSeqNumCont","data","productionQueues","configEnums","productNum","productId","carDescription","remarkremark","eee","fff","ggg","subassemblyOnlineDTOs","productNUM","productionSeqNum","remark","dln","lsn","configCode","configText","valueText","fileName","init","this","emptySureData","setZoom","page","improveData","offEvent","translate","promiseInitData","_this","getSysModuleConfig","done","response","parseJSON","isEmpty","setBreadcrumb","initEvent","initData","off","flag","alert","type","text","changePage","getDataAndRender","renderNowPage","html","status","parseInt","canSure","removeClass","addClass","sureKey","document","on","event","keyCode","trigger","View","initialize","current","events",".u-quePage a:eq(0)",".u-quePage a:eq(1)",".u-queuingRefresh",".u-queuingSure:not(.u-queue-disabled)","eventsFunction","prevPage","changePageRender","nextPage","refresh","sure","str","arr","params","productTrackNum","createUser","extend","forEach","value","index","service","subassemblyOnlinesJson","url","pageNum","getNum","stNum","num","ajaxSucc","triggerSuccessEvun","haveData","render","noData","errorMessage","totalHistoryRender","length","push","key","processData","tplManager","total","history","call"],"mappings":"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","file":"assets/js/pages/pcs_queuingDoubleIndication_ba49ca072141a3a53045.js","sourcesContent":["webpackJsonp([25],{\n\n/***/ 635:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($, notie) {\n\nvar _stringify = __webpack_require__(38);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar kit = __webpack_require__(78);\nvar security = __webpack_require__(35);\nvar util = __webpack_require__(34);\nvar productionSeqNum = \"productId\";\n\nvar options = {\n\tmoduleConfig: {\n\t\tconfigCodes: [],\n\t\trowNum: 10,\n\t\tstationCode: \"\",\n\t\ttitle: \"\",\n\t\treverse: \"\" },\n\n\tconfig: {\n\t\tnowPage: 0,\n\t\tifReverse: false,\n\t\tresetPage: 0,\n\t\tcanSurePage: 0,\n\t\trowNum: 10,\n\t\tpageSize: 2,\n\t\tsiteCode: security.getSiteCode(),\n\t\tStationCode: \"\",\n\t\turlDetail: \"GMES-CLIENT-PCS0011\",\n\t\turlHistory: \"GMES-CLIENT-PCS0012\" }\n};\n\nvar queuingDoubleIndicationCtrl = {\n\tqueueType: \"productionQueues\",\n\tsureDataCont: [],\n\tproductNumCont: [],\n\tproductionSeqNumCont: [],\n\tdata: {\n\t\tproductionQueues: [{\n\t\t\tconfigEnums: [],\n\t\t\tproductNum: \"--\",\n\t\t\tproductId: \"--\",\n\t\t\tcarDescription: \"--\",\n\t\t\tremarkremark: \"--\",\n\t\t\teee: \"\",\n\t\t\tfff: \"--\",\n\t\t\tggg: \"--\" }, {}],\n\n\t\tsubassemblyOnlineDTOs: [{\n\t\t\tconfigEnums: [],\n\t\t\tproductNum: \"--\",\n\t\t\tproductNUM: \"--\",\n\t\t\tproductionSeqNum: \"--\",\n\t\t\tcarDescription: \"--\",\n\t\t\tremark: \"--\",\n\t\t\teee: \"\",\n\t\t\tfff: \"--\",\n\t\t\tggg: \"--\" }, {}],\n\t\tdln: \"--\",\n\t\tlsn: \"--\",\n\t\tconfigEnums: [{\n\t\t\tconfigCode: \"YB\",\n\t\t\tconfigText: \"\",\n\t\t\tvalueText: \"\",\n\t\t\tfileName: \"\" }, {\n\t\t\tconfigCode: \"ZYB\",\n\t\t\tconfigText: \"\",\n\t\t\tvalueText: \"\",\n\t\t\tfileName: \"\" }] },\n\n\tinit: function init() {\n\t\toptions.config.nowPage = 0;\n\n\t\tthis.emptySureData();\n\t\tutil.setZoom(this.page);\n\t\tthis.improveData();\n\t\tthis.offEvent();\n\t\tutil.translate(this.page);\n\t\tthis.promiseInitData();\n\t},\n\n\timproveData: function improveData() {\n\t\tthis.data.productionQueues[1] = this.data.productionQueues[0];\n\t\tthis.data.subassemblyOnlineDTOs[1] = this.data.subassemblyOnlineDTOs[0];\n\t},\n\tpromiseInitData: function promiseInitData() {\n\t\tvar _this = this;\n\n\t\tsecurity.getSysModuleConfig(\"PCS\", \"DOUBLE_ONLINE_INDICATION\").done(function (response) {\n\t\t\toptions.moduleConfig = response.data ? $.parseJSON(response.data) : {};\n\n\t\t\tif (kit.isEmpty(options.moduleConfig) === false) {\n\t\t\t\toptions.config.ifReverse = options.moduleConfig.reverse;\n\t\t\t\tutil.setBreadcrumb([(options.moduleConfig[\"title\"] || \"\") + \" \" + options.moduleConfig.stationCode]);\n\n\t\t\t\t_this.initEvent();\n\t\t\t\t_this.initData();\n\t\t\t}\n\t\t});\n\t},\n\toffEvent: function offEvent() {\n\t\t$(\"#queuingDoubleIndication\").off();\n\t},\n\n\tinitData: function initData(flag) {\n\t\tif (flag) {\n\t\t\tnotie.alert({ type: \"1\", text: \"成功确认\" });\n\t\t}\n\n\t\tthis.changePage(true);\n\t\tthis.getDataAndRender();\n\t},\n\temptySureData: function emptySureData() {\n\t\tthis.sureDataCont = [];\n\t\tthis.productNumCont = [];\n\t\tthis.productionSeqNumCont = [];\n\t},\n\n\trenderNowPage: function renderNowPage(page) {\n\t\t$(\".u-queue-now\").html(page);\n\t},\n\n\tchangePage: function changePage(status) {\n\n\t\tif (status === true) {\n\t\t\toptions.config.nowPage = options.config.resetPage;\n\t\t} else {\n\t\t\tstatus = parseInt(status);\n\t\t\toptions.config.nowPage += status;\n\t\t}\n\n\t\tthis.canSure(options.config.nowPage);\n\t\tthis.renderNowPage(options.config.nowPage);\n\t},\n\n\tcanSure: function canSure(page) {\n\t\tif (page === options.config.canSurePage) {\n\t\t\t$(\".u-queuingSure\").removeClass(\"u-queue-disabled\");\n\t\t} else {\n\t\t\t$(\".u-queuingSure\").addClass(\"u-queue-disabled\");\n\t\t}\n\t},\n\n\tsureKey: function sureKey() {\n\t\t$(document).on(\"keydown\", function (event) {\n\n\t\t\tif (event.keyCode === 13) {\n\t\t\t\t$(\".u-queuingSure:not(.u-queue-disabled)\").trigger(\"click\");\n\t\t\t} else if (event.keyCode === 39) {\n\t\t\t\t$(\".u-quePage a:eq(1)\").trigger(\"click\");\n\t\t\t} else if (event.keyCode === 37) {\n\t\t\t\t$(\".u-quePage a:eq(0)\").trigger(\"click\");\n\t\t\t} else if (event.keyCode === 40) {\n\t\t\t\t$(\".u-queuingRefresh\").trigger(\"click\");\n\t\t\t}\n\t\t});\n\t},\n\tinitEvent: function initEvent() {\n\t\tvar _this = this;\n\t\tthis.sureKey();\n\n\t\tnew kit.View({\n\t\t\tinitialize: function initialize() {},\n\t\t\tcurrent: $(\"#queuingDoubleIndication\"),\n\t\t\tevents: {\n\t\t\t\t\".u-quePage a:eq(0)\": \"prevPage\",\n\t\t\t\t\".u-quePage a:eq(1)\": \"nextPage\",\n\t\t\t\t\".u-queuingRefresh\": \"refresh\",\n\t\t\t\t\".u-queuingSure:not(.u-queue-disabled)\": \"sure\" },\n\t\t\teventsFunction: {\n\t\t\t\tprevPage: function prevPage() {\n\t\t\t\t\tvar total = parseInt($(\".u-queue-history\").html(), 10);\n\n\n\t\t\t\t\t_this.changePageRender(-1);\n\t\t\t\t},\n\t\t\t\tnextPage: function nextPage() {\n\t\t\t\t\tvar total = parseInt($(\".u-queue-total\").html(), 10);\n\n\t\t\t\t\t_this.changePageRender(1);\n\t\t\t\t},\n\t\t\t\trefresh: function refresh() {\n\t\t\t\t\t_this.changePage(true);\n\t\t\t\t\t_this.getDataAndRender();\n\t\t\t\t},\n\t\t\t\tsure: function sure() {\n\t\t\t\t\tvar arr = [];\n\t\t\t\t\tvar str;\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\tstationCode: \"\",\n\t\t\t\t\t\tsiteCode: options.config.siteCode,\n\t\t\t\t\t\tpageSize: options.config.pageSize,\n\t\t\t\t\t\tproductNum: \"\",\n\t\t\t\t\t\tproductTrackNum: \"\",\n\t\t\t\t\t\tcreateUser: \"\" };\n\n\t\t\t\t\tparams = $.extend(params, options.moduleConfig);\n\n\t\t\t\t\tkit.forEach(_this.sureDataCont, function (value, index) {\n\t\t\t\t\t\tarr[index] = $.extend(true, {}, params);\n\t\t\t\t\t\tarr[index].productNum = _this.sureDataCont[index];\n\t\t\t\t\t});\n\n\t\t\t\t\tkit.forEach(_this.productNumCont, function (value, index) {\n\t\t\t\t\t\tarr[index] = $.extend(true, {}, params);\n\t\t\t\t\t\tarr[index].productNum = _this.productNumCont[index];\n\t\t\t\t\t});\n\n\t\t\t\t\tkit.forEach(_this.productionSeqNumCont, function (value, index) {\n\t\t\t\t\t\tarr[index].productionSeqNum = _this.productionSeqNumCont[index];\n\t\t\t\t\t});\n\n\t\t\t\t\tstr = (0, _stringify2.default)(arr);\n\n\t\t\t\t\tutil.service(\"GMES-CLIENT-PCS0013\", { subassemblyOnlinesJson: str }, \"正在确认...\").done(function () {\n\t\t\t\t\t\t_this.initData(true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tchangePageRender: function changePageRender(page) {\n\t\tthis.changePage(page);\n\t\tthis.getDataAndRender();\n\t},\n\n\tgetDataAndRender: function getDataAndRender() {\n\t\tvar _this = this;\n\t\tvar url;\n\n\t\tif (options.config.nowPage >= 0) {\n\t\t\turl = options.config.urlDetail;\n\t\t\tthis.queueType = \"productionQueues\";\n\t\t} else {\n\t\t\turl = options.config.urlHistory;\n\t\t\tthis.queueType = \"subassemblyOnlineDTOs\";\n\t\t}\n\n\t\tvar params = {\n\t\t\tstationCode: \"\",\n\t\t\tpageNum: options.config.nowPage,\n\t\t\tgetNum: options.config.pageSize,\n\t\t\tsiteCode: options.config.siteCode,\n\t\t\trowNum: 10,\n\t\t\tstNum: 2,\n\t\t\tnum: options.moduleConfig.rowNum };\n\n\t\tparams = $.extend(params, options.moduleConfig);\n\n\t\tutil.service(url, params, \"正在加载中\").done(function (response) {\n\t\t\t_this.ajaxSucc(response);\n\t\t});\n\t},\n\tajaxSucc: function ajaxSucc(response) {\n\t\tvar _this = this;\n\n\t\tkit.triggerSuccessEvun({\n\t\t\tresponse: response,\n\t\t\thaveData: function haveData(data) {\n\t\t\t\t_this.emptySureData();\n\t\t\t\t_this.render(data, true);\n\t\t\t},\n\t\t\tnoData: function noData() {\n\t\t\t\tnotie.alert({ type: 1, text: \"无数据 \" + response.errorMessage });\n\t\t\t\t_this.render(_this.data);\n\t\t\t}\n\t\t});\n\t},\n\n\trender: function render(data, flag) {\n\t\tvar arr = data[this.queueType];\n\t\tvar _this = this;\n\n\t\tif (flag === true) {\n\t\t\tthis.totalHistoryRender(data.dln - 1, -data.lsn);\n\t\t}\n\n\t\tif (arr.length < 2) {\n\t\t\tif (arr.length === 0) {\n\t\t\t\t$(\".u-queuingSure\").addClass(\"u-queue-disabled\");\n\t\t\t}\n\t\t\tarr.push(_this.data[this.queueType]);\n\t\t\tif (arr.length < 2) {\n\t\t\t\tarr.push(_this.data[this.queueType]);\n\t\t\t}\n\t\t}\n\n\t\tkit.forEach(arr, function (value, key) {\n\t\t\t_this.sureDataCont.push(arr[key].productNum);\n\t\t\t_this.productNumCont.push(arr[key].productNum);\n\t\t\t_this.productionSeqNumCont.push(arr[key][productionSeqNum]);\n\t\t});\n\n\t\tkit.forEach(arr, function (value, index) {\n\t\t\tarr[index] = util.processData(options.moduleConfig, arr[index]);\n\t\t});\n\n\t\tif (options.config.ifReverse) {\n\t\t\tarr.reverse();\n\t\t}\n\n\t\tutil.tplManager(\"queuingDoubleTpl\", arr[0], \"leftQueue\");\n\t\tutil.tplManager(\"queuingDoubleTpl\", arr[1], \"rightQueue\");\n\t},\n\n\ttotalHistoryRender: function totalHistoryRender(total, history) {\n\t\tif (total < 0) {\n\t\t\ttotal = 0;\n\t\t}\n\t\t$(\".u-queue-total\").html(total);\n\t\t$(\".u-queue-history\").html(history);\n\t}\n};\n\nmodule.exports = queuingDoubleIndicationCtrl;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(4), __webpack_require__(36)))\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// assets/js/pages/pcs_queuingDoubleIndication_ba49ca072141a3a53045.js","/*\r\n * @name: pages\\pcs\\queuingDoubleIndication.js\r\n * @author: EVUN前端组\r\n * @modify: kelichao \r\n * @update: 2017-06-13\r\n * @decript: 上件指示（双）\r\n * @url: http://git.evun.cn/GMES/GMES_CLIENT_PAD\r\n */\r\n\r\nvar kit = require(\"kit\");\r\nvar security = require(\"security\");// 用于获取请求参数的封装体\r\nvar util = require(\"util\");\r\nvar productionSeqNum = \"productId\";\r\n\r\nvar options = {\r\n\t// 模块站点配置,在拿到数据体后对该对象进行赋值，初始化仅为展示字段\r\n    moduleConfig: {\r\n\t\tconfigCodes:[],\r\n\t\trowNum:10,\r\n\t\tstationCode:\"\",\r\n\t\ttitle:\"\",\r\n\t\treverse:\"\",// 是否需要反转\r\n\t},\r\n\t// 数据配置项\r\n\tconfig: {\r\n\t\tnowPage: 0,// 当前页码\r\n\t\tifReverse: false,// 是否需要反转\r\n\t\tresetPage: 0,// 初始化页码数值\r\n\t\tcanSurePage: 0,// 可以进行确认按钮的页码\r\n\t\trowNum: 10,// 队列长度，写死\r\n\t\tpageSize:2,// 每页指导数组数量\r\n\t\tsiteCode: security.getSiteCode(),// 站点信息 \"1310\"\r\n\t\tStationCode: \"\",// 站点代码 \"0608ZD1\"\r\n\t\turlDetail: \"GMES-CLIENT-PCS0011\",// 链接标识\r\n\t\turlHistory: \"GMES-CLIENT-PCS0012\"//历史标识\r\n\t},\r\n};\r\n\r\nvar queuingDoubleIndicationCtrl = {\r\n\tqueueType: \"productionQueues\",// 队列：productionQueues, 历史：subassemblyOnlineDTOs\r\n\tsureDataCont: [],// 确认按钮数据缓存\r\n\tproductNumCont:[],// 缓存产品跟踪号 \r\n\tproductionSeqNumCont: [],// 生产管理号\r\n    // 数据初始化\r\n    data: {\r\n\t\t// 当前列队数据[0, 1]\r\n\t\tproductionQueues: [\r\n\t\t\t{\r\n\t\t\t\tconfigEnums:[],\r\n\t\t\t\tproductNum: \"--\",// 产品标识号\r\n\t\t\t\tproductId: \"--\",// 生产管理号/产品管理号\r\n\t\t\t\tcarDescription: \"--\",// 产品规格\r\n\t\t\t\tremarkremark: \"--\",// 备注\r\n\t\t\t\teee: \"\",// 图片素材\r\n\t\t\t\tfff: \"--\",// 道路事故数据\r\n\t\t\t\tggg: \"--\"// 转向器数据\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t// 同第一条\r\n\t\t\t},\r\n\t\t],\r\n\t\t// 历史数据\r\n\t\tsubassemblyOnlineDTOs:[\r\n\t\t{\r\n\t\t\tconfigEnums:[],\r\n\t\t\tproductNum: \"--\",//产品标识号\r\n\t\t\tproductNUM: \"--\",// 产品跟踪号 \r\n\t\t\tproductionSeqNum: \"--\",//  生产管理号\r\n\t\t\tcarDescription: \"--\",// 产品规格\r\n\t\t\tremark: \"--\",// 备注\r\n\t\t\teee: \"\",// 图片素材\r\n\t\t\tfff: \"--\",// 道路事故数据\r\n\t\t\tggg: \"--\"// 转向器数据\r\n\t\t},{\r\n\t\t\t// 同第一条\r\n\t\t}\r\n\t\t],\r\n\t\tdln: \"--\",// 列队总页数\r\n\t\tlsn: \"--\",// 历史总列数\r\n\t\tconfigEnums: [{\r\n\t\t\tconfigCode:\"YB\",// 配置编号 \r\n\t\t\tconfigText: \"\",// 配置描述\r\n\t\t\tvalueText: \"\",//配置详情描述\r\n\t\t\tfileName: \"\"// 图片文件名\r\n\t\t},{\r\n\t\t\tconfigCode:\"ZYB\",// 配置编号 \r\n\t\t\tconfigText: \"\",// 配置描述\r\n\t\t\tvalueText: \"\",//配置详情描述\r\n\t\t\t fileName: \"\"// 图片文件名\r\n\t\t}]// 特性列表\r\n    },\r\n\t// 初始化\r\n\tinit: function() {\r\n\r\n\t\t// 初始化页码\r\n\t\toptions.config.nowPage = 0;\r\n\r\n\t\tthis.emptySureData();\r\n\t\tutil.setZoom(this.page);\r\n\t\tthis.improveData();// 完善初始化数据\r\n\t\tthis.offEvent();// 移除先前的事件绑定\r\n\t\tutil.translate(this.page);\r\n\t\tthis.promiseInitData();// 初始化数据，但是要在之前要请求stationCode\r\n\t},\r\n\t// 完善初始化数据\r\n\timproveData: function() {\r\n\t\tthis.data.productionQueues[1] = this.data.productionQueues[0];\r\n\t\tthis.data.subassemblyOnlineDTOs[1] = this.data.subassemblyOnlineDTOs[0];\r\n\t},\r\n\tpromiseInitData: function() {\r\n\t\tvar _this = this;\r\n\t\t// 这个请求需要做成异步\r\n\t\tsecurity.getSysModuleConfig(\"PCS\",\"DOUBLE_ONLINE_INDICATION\")\r\n\t\t\t.done(function(response) {\r\n\t\t\t\toptions.moduleConfig = response.data? $.parseJSON(response.data) : {};\r\n\r\n\t\t\t\t// 如果配置站点为空，则不初始化\r\n\t\t\t\tif (kit.isEmpty(options.moduleConfig) === false) {\r\n\t\t\t\t\toptions.config.ifReverse = options.moduleConfig.reverse;\r\n\t\t\t\t\tutil.setBreadcrumb([(options.moduleConfig[\"title\"] || \"\") + \" \" + options.moduleConfig.stationCode]);\r\n            \r\n\t\t\t\t\t_this.initEvent();// 事件初始化\r\n\t\t\t\t\t_this.initData();// 初始化数据时，获取站点配置信息，首次加载并渲染本页面数据\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t},\r\n\toffEvent: function() {\r\n\t\t// 卸载容器事件\r\n\t\t$(\"#queuingDoubleIndication\").off();\r\n\t},\r\n\t/**\r\n\t * 如果有状态值true，弹出弹框成功确认，主要用于确认按钮。\r\n\t * @param {Boolean} flag \r\n\t */\r\n    initData: function (flag) {\r\n\t\tif (flag) {\r\n\t\t\tnotie.alert({type: \"1\",text: \"成功确认\"});\r\n\t\t}\r\n\r\n\t\tthis.changePage(true);// 初始化页码\r\n        this.getDataAndRender();\r\n    },\r\n\temptySureData: function() {\r\n\t\tthis.sureDataCont = [];\r\n\t\tthis.productNumCont = [];\r\n\t\tthis.productionSeqNumCont = [];\r\n\t},\r\n\t// 渲染页码\r\n\trenderNowPage: function(page) {\r\n\t\t$(\".u-queue-now\").html(page);\r\n\t},\r\n\t/**\r\n\t * 修改页码,输入str转为数字，输入num为普通改变，输入true则重置页码到0\r\n\t * @param {flag/number/str} status \r\n\t */\r\n\tchangePage: function(status) {\r\n\r\n\t\tif (status === true) {\r\n\t\t\t// 重置页码\r\n\t\t\toptions.config.nowPage = options.config.resetPage;\r\n\t\t} else {\r\n\t\t\t// 判断页码是否可以转化为数字\r\n\t\t\tstatus = parseInt(status);\r\n\t\t\toptions.config.nowPage += status;\r\n\t\t}\r\n\r\n\t\tthis.canSure(options.config.nowPage);\r\n\t\tthis.renderNowPage(options.config.nowPage);\r\n\t},\r\n\t// 是否需要屏蔽确认按钮\r\n\tcanSure: function(page) {\r\n\t\tif (page === options.config.canSurePage ) {\r\n\t\t\t$(\".u-queuingSure\").removeClass(\"u-queue-disabled\");\r\n\t\t}else {\r\n\t\t\t$(\".u-queuingSure\").addClass(\"u-queue-disabled\");\r\n\t\t}\r\n\t},\r\n\t// 确认回车需要全局绑定\r\n\tsureKey: function() {\r\n\t\t$(document).on(\"keydown\", function(event) {\r\n\r\n\t\t\tif(event.keyCode === 13) {// 回车键\r\n\t\t\t\t$(\".u-queuingSure:not(.u-queue-disabled)\").trigger(\"click\");\r\n\t\t\t} else if (event.keyCode === 39) {// 向右\r\n\t\t\t\t$(\".u-quePage a:eq(1)\").trigger(\"click\");\r\n\t\t\t} else if(event.keyCode === 37){// 向左\r\n\t\t\t\t$(\".u-quePage a:eq(0)\").trigger(\"click\");\r\n\t\t\t} else if (event.keyCode === 40) {\r\n\t\t\t\t$(\".u-queuingRefresh\").trigger(\"click\");\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tinitEvent: function() {\r\n\t\tvar _this = this;\r\n\t\tthis.sureKey();\r\n\r\n\t\tnew kit.View({\r\n\t\t\tinitialize: function() {\r\n\t\t\t},\r\n\t\t\tcurrent: $(\"#queuingDoubleIndication\"),\r\n\t\t\tevents: {\r\n\t\t\t\t\".u-quePage a:eq(0)\": \"prevPage\",// 前一页\r\n\t\t\t\t\".u-quePage a:eq(1)\": \"nextPage\",// 后一页\r\n\t\t\t\t\".u-queuingRefresh\": \"refresh\",// 刷新\r\n\t\t\t\t\".u-queuingSure:not(.u-queue-disabled)\": \"sure\"// 确认装配\r\n\t\t\t},\r\n\t\t\teventsFunction: {\r\n\t\t\t\tprevPage: function() {\r\n\t\t\t\t\tvar total = parseInt($(\".u-queue-history\").html(), 10);\r\n\t\t\t\t\t// if (options.config.nowPage <= total) {\r\n\t\t\t\t\t// \tnotie.alert({text: \"页码已经最小\"});\r\n\t\t\t\t\t// \treturn;\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t\r\n\t\t\t\t\t_this.changePageRender(-1);\r\n\t\t\t\t},\r\n\t\t\t\tnextPage: function() {\r\n\t\t\t\t\tvar total = parseInt($(\".u-queue-total\").html(), 10);\r\n\r\n\t\t\t\t\t// if (options.config.nowPage >= total) {\r\n\t\t\t\t\t// \tnotie.alert({text: \"页码已经最大\"});\r\n\t\t\t\t\t// \treturn;\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t_this.changePageRender(1);\r\n\t\t\t\t},\r\n\t\t\t\trefresh: function() {\r\n\t\t\t\t\t_this.changePage(true);// 初始化页码\r\n\t\t\t\t\t_this.getDataAndRender();\r\n\t\t\t\t},\r\n\t\t\t\tsure: function() {\r\n\t\t\t\t\tvar arr = [];\r\n\t\t\t\t\tvar str;\r\n\t\t\t\t\tvar params = {\r\n\t\t\t\t\t\tstationCode: \"\",// app.stationCode\r\n\t\t\t\t\t\tsiteCode: options.config.siteCode,// 站点信息\r\n\t\t\t\t\t\tpageSize: options.config.pageSize,// 每页数量\r\n\t\t\t\t\t\tproductNum: \"\",// 产品标识号\r\n\t\t\t\t\t\tproductTrackNum: \"\",// 产品跟踪号  先空\r\n\t\t\t\t\t\tcreateUser: \"\"// 用户  先不用\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// 添加模块配置\r\n\t\t\t\t\tparams = $.extend(params, options.moduleConfig);\r\n\r\n\t\t\t\t\t// 把缓存的确认要传的数据添加上\r\n\t\t\t\t\tkit.forEach(_this.sureDataCont, function(value, index) {\r\n\t\t\t\t\t\tarr[index] = $.extend(true, {}, params);\r\n\t\t\t\t\t\tarr[index].productNum = _this.sureDataCont[index];\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 缓存产品跟踪号\r\n\t\t\t\t\tkit.forEach(_this.productNumCont, function(value, index) {\r\n\t\t\t\t\t\tarr[index] = $.extend(true, {}, params);\r\n\t\t\t\t\t\tarr[index].productNum = _this.productNumCont[index];\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// // 缓存生产管理号，这里命名不同\r\n\t\t\t\t\tkit.forEach(_this.productionSeqNumCont, function(value, index) {\r\n\t\t\t\t\t\t// arr[index] = $.extend(true, {}, params);\r\n\t\t\t\t\t\tarr[index].productionSeqNum = _this.productionSeqNumCont[index];\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tstr = JSON.stringify(arr);\r\n\r\n\t\t\t\t\t// 上线确认按钮\r\n\t\t\t\t\tutil.service(\"GMES-CLIENT-PCS0013\", {subassemblyOnlinesJson: str}, \"正在确认...\")\r\n\t\t\t\t\t\t.done(function(){_this.initData(true);});\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tchangePageRender: function(page) {\r\n\t\tthis.changePage(page);\r\n\t\tthis.getDataAndRender();\r\n\t},\r\n    // 获取页面数据并刷新页面-右\r\n    getDataAndRender: function () {\r\n        var _this = this;\r\n\t\tvar url;\r\n\r\n\t\tif (options.config.nowPage >= 0) {\r\n\t\t\turl = options.config.urlDetail;\r\n\t\t\tthis.queueType = \"productionQueues\";\r\n\t\t} else {\r\n\t\t\turl = options.config.urlHistory;\r\n\t\t\tthis.queueType = \"subassemblyOnlineDTOs\";\r\n\t\t}\r\n\r\n\t\tvar params = {\r\n    \t    stationCode: \"\",// app.stationCode // TR01 : 这个站点有数据\r\n\t\t\tpageNum: options.config.nowPage,// 当前页码\r\n\t\t\tgetNum: options.config.pageSize,// 每页数量\r\n\t\t\tsiteCode: options.config.siteCode,// 站点信息\r\n\t\t\trowNum:10,// 队列长度\r\n\t\t\t// 新增参数\r\n\t\t\tstNum: 2,// 新增参数 初始位置\r\n\t\t\tnum: options.moduleConfig.rowNum// 新增参数 列队最大数量\r\n    \t};\r\n\r\n\t\tparams = $.extend(params, options.moduleConfig);\r\n\r\n    \tutil.service(url, params, \"正在加载中\")\r\n    \t.done(function(response){_this.ajaxSucc(response);});\r\n    },\r\n\tajaxSucc: function(response) {\r\n\t\tvar _this = this;\r\n\r\n\t\t// 模拟无数据情况\r\n\t\t//response.returnCode = 1;\r\n\r\n\t\tkit.triggerSuccessEvun({\r\n\t\t\tresponse: response,\r\n\t\t\thaveData: function(data) {\r\n\t\t\t\t_this.emptySureData();\r\n\t\t\t\t_this.render(data, true);// 正常渲染有数据\r\n\t\t\t},\r\n\t\t\tnoData: function() {\r\n\t\t\t\tnotie.alert({type: 1,text: \"无数据 \" + response.errorMessage});\r\n      \t\t\t_this.render(_this.data);// 正常渲染无数据\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * 模板渲染，如果flag为true代表有数据渲染，渲染总页码，false则直接用初始化数据渲染\r\n\t * @param {object} data \r\n\t * @param {boolean} flag\r\n\t */\r\n\trender: function(data, flag) {\r\n\t\tvar arr = data[this.queueType];\r\n\t\tvar _this = this;\r\n\r\n\t\t// 如果是有数据的渲染\r\n\t\tif (flag === true) {\r\n\t\t\t// 总页码单独渲染,由于当前操作对象0属于队列，要减去1\r\n\t\t\tthis.totalHistoryRender(data.dln - 1, -data.lsn);\r\n\t\t}\r\n\r\n\t\t// 如果长度不够，只有单边的情况，则用初始化数据填补\r\n\t\tif (arr.length < 2) {\r\n\t\t\tif (arr.length === 0) {\r\n\t\t\t\t$(\".u-queuingSure\").addClass(\"u-queue-disabled\");\r\n\t\t\t}\r\n\t\t\tarr.push(_this.data[this.queueType]);\r\n\t\t\tif (arr.length < 2) {\r\n\t\t\t\tarr.push(_this.data[this.queueType]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// 缓存产品标识\r\n\t\tkit.forEach(arr, function(value, key) {\r\n\t\t\t_this.sureDataCont.push(arr[key].productNum);\r\n\t\t\t_this.productNumCont.push(arr[key].productNum);// 产品管理号\r\n\t\t\t_this.productionSeqNumCont.push(arr[key][productionSeqNum]);// 生产管理号\r\n\t\t\t//arr[key].pircture = util.processImg(options.moduleConfig, arr[key]);\r\n\t\t});\r\n\r\n\t\t// 筛选特性数据\r\n\t\tkit.forEach(arr, function(value, index) {\r\n\t\t\tarr[index] = util.processData(options.moduleConfig, arr[index]);\r\n\t\t});\r\n\r\n\t\t// 如果需要反转\r\n\t\tif (options.config.ifReverse) {\r\n\t\t\tarr.reverse();\r\n\t\t}\r\n\r\n\t\tutil.tplManager(\"queuingDoubleTpl\", arr[0], \"leftQueue\");\r\n\t\tutil.tplManager(\"queuingDoubleTpl\", arr[1], \"rightQueue\");\r\n\t},\r\n\r\n\ttotalHistoryRender: function(total, history) {\r\n\t\tif (total < 0) {\r\n\t\t\ttotal = 0;\r\n\t\t}\r\n\t\t$(\".u-queue-total\").html(total);\r\n\t\t$(\".u-queue-history\").html(history);\r\n\t}\r\n};\r\n\r\nmodule.exports = queuingDoubleIndicationCtrl;\n\n\n// WEBPACK FOOTER //\n// ./src/js/pages/pcs/queuingDoubleIndication.js"],"sourceRoot":""}