webpackJsonp([34],{622:function(t,n,e){"use strict";(function(n,a,o,i){var s=e(35),r=e(80),d=e(34),c={STATE_TOUCH:1,STATE_NORMAL:3,page:void 0,station:void 0,init:function(){n(document).off("keydown"),d.translate('.page[data-page="andonQuality"]');var t=this;this.clearSchedule(),s.isUniqueOperableStation(function(n){d.setBreadcrumb([a.t("ANDON.T.MENU_ANDONQUALITY")+"/"+n.stationText]),t.station=n,t.loadPage()}),myApp.onPageBeforeRemove("andonQuality",function(t){andonQualityView.clearSchedule()})},clearSchedule:function(){r.remove("andonStatusSync")},event:function(){var t=this;n.each(n("a[type='andon']",this.page),function(n,e){t.changeAndonDispay(e)}),n("a[type='andon']").on("click",function(e){var i="andon"==n(e.target).attr("type")?n(e.target):n(e.target).parents("a[type='andon']"),s=i.attr("statusECode"),r=i.attr("andonCode");d.service("GMES-CLIENT-ANDON009",{stationCode:t.station.stationCode,andonCode:r,statusECode:s},null,function(n){var e=n.data;e&&(i.attr("statusECode",e.statusECode),t.isTouched(e.statusECode)?(i.attr("switchOnDateTime",e.switchOnDateTime),o.notify({type:"success",content:a.t("ANDON.T.MSG_TOUCH_SUCCESS",{andonText:i.attr("andonText")})})):(i.attr("switchOnDateTime",""),i.find(".touch-time").text(""),o.notify({type:"success",content:a.t("ANDON.T.MSG_CLOSE_SUCCESS",{andonText:i.attr("andonText")})})),t.changeAndonDispay(i),t.warningDisplay())})})},loadPage:function(){var t=this;d.service("GMES-CLIENT-ANDON008",{stationCode:t.station.stationCode,andonTypeCode:"ZLANDON"},a.t("ANDON.T.MSG_ANDON_LOADING"),function(e){var a=e.data,o=t.group(a,6);if(d.tplManager("andonQualitySwiperTpl",o,"andonQualitySwiperRender"),a.length>6){F7.swiper(n(".swiper-container",t.page),{pagination:n(".swiper-pagination",t.page),nextButton:n(".swiper-button-next",t.page),prevButton:n(".swiper-button-prev",t.page)})}t.event(),t.warningDisplay()})},changeAndonDispay:function(t){var e=n(t);if(e.attr("statusECode")==this.STATE_TOUCH){var a=i(s.getServerDataTime()),o=a.diff(e.attr("switchOnDateTime"));o<=1e4?e.css("background","linear-gradient(to bottom, #f4b664, #e9822d)"):e.css("background",e.attr("touchColor")),e.find(".touch-time").text(this.calTime(o))}else e.css("background",e.attr("normalColor"))},warningDisplay:function(){n("a[type='andon'][statusECode='1']",this.page).length>0?n(this.page).find("div.page-content").addClass("andon-bg-blink"):n(this.page).find("div.page-content").removeClass("andon-bg-blink")},render:function(t){},isTouched:function(t){return t==this.STATE_TOUCH},group:function(t,n){for(var e=0,a={groupAndons:[]};e<t.length;)a.groupAndons.push(t.slice(e,e+=n));return a},calTime:function(t){var n=Math.floor(t/6e4);n=0!=n?a.t("COMMON.T.MINUTE",{minute:n}):"";var e=t%6e4,o=Math.round(e/1e3);return o=0!=o?a.t("COMMON.T.SECOND",{second:o}):"",n+o}};t.exports=c}).call(n,e(4),e(37),e(77),e(30))}});
//# sourceMappingURL=andon_andonQuality_940460adab9fdca7830f.js.map