webpackJsonp([25],{635:function(e,t,n){"use strict";(function(t,u){var o=n(38),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(78),r=n(35),s=n(34),c={moduleConfig:{configCodes:[],rowNum:10,stationCode:"",title:"",reverse:""},config:{nowPage:0,ifReverse:!1,resetPage:0,canSurePage:0,rowNum:10,pageSize:2,siteCode:r.getSiteCode(),StationCode:"",urlDetail:"GMES-CLIENT-PCS0011",urlHistory:"GMES-CLIENT-PCS0012"}},g={queueType:"productionQueues",sureDataCont:[],productNumCont:[],productionSeqNumCont:[],data:{productionQueues:[{configEnums:[],productNum:"--",productId:"--",carDescription:"--",remarkremark:"--",eee:"",fff:"--",ggg:"--"},{}],subassemblyOnlineDTOs:[{configEnums:[],productNum:"--",productNUM:"--",productionSeqNum:"--",carDescription:"--",remark:"--",eee:"",fff:"--",ggg:"--"},{}],dln:"--",lsn:"--",configEnums:[{configCode:"YB",configText:"",valueText:"",fileName:""},{configCode:"ZYB",configText:"",valueText:"",fileName:""}]},init:function(){c.config.nowPage=0,this.emptySureData(),s.setZoom(this.page),this.improveData(),this.offEvent(),s.translate(this.page),this.promiseInitData()},improveData:function(){this.data.productionQueues[1]=this.data.productionQueues[0],this.data.subassemblyOnlineDTOs[1]=this.data.subassemblyOnlineDTOs[0]},promiseInitData:function(){var e=this;r.getSysModuleConfig("PCS","DOUBLE_ONLINE_INDICATION").done(function(n){c.moduleConfig=n.data?t.parseJSON(n.data):{},!1===a.isEmpty(c.moduleConfig)&&(c.config.ifReverse=c.moduleConfig.reverse,s.setBreadcrumb([(c.moduleConfig.title||"")+" "+c.moduleConfig.stationCode]),e.initEvent(),e.initData())})},offEvent:function(){t("#queuingDoubleIndication").off()},initData:function(e){e&&u.alert({type:"1",text:"成功确认"}),this.changePage(!0),this.getDataAndRender()},emptySureData:function(){this.sureDataCont=[],this.productNumCont=[],this.productionSeqNumCont=[]},renderNowPage:function(e){t(".u-queue-now").html(e)},changePage:function(e){!0===e?c.config.nowPage=c.config.resetPage:(e=parseInt(e),c.config.nowPage+=e),this.canSure(c.config.nowPage),this.renderNowPage(c.config.nowPage)},canSure:function(e){e===c.config.canSurePage?t(".u-queuingSure").removeClass("u-queue-disabled"):t(".u-queuingSure").addClass("u-queue-disabled")},sureKey:function(){t(document).on("keydown",function(e){13===e.keyCode?t(".u-queuingSure:not(.u-queue-disabled)").trigger("click"):39===e.keyCode?t(".u-quePage a:eq(1)").trigger("click"):37===e.keyCode?t(".u-quePage a:eq(0)").trigger("click"):40===e.keyCode&&t(".u-queuingRefresh").trigger("click")})},initEvent:function(){var e=this;this.sureKey(),new a.View({initialize:function(){},current:t("#queuingDoubleIndication"),events:{".u-quePage a:eq(0)":"prevPage",".u-quePage a:eq(1)":"nextPage",".u-queuingRefresh":"refresh",".u-queuingSure:not(.u-queue-disabled)":"sure"},eventsFunction:{prevPage:function(){parseInt(t(".u-queue-history").html(),10);e.changePageRender(-1)},nextPage:function(){parseInt(t(".u-queue-total").html(),10);e.changePageRender(1)},refresh:function(){e.changePage(!0),e.getDataAndRender()},sure:function(){var n,u=[],o={stationCode:"",siteCode:c.config.siteCode,pageSize:c.config.pageSize,productNum:"",productTrackNum:"",createUser:""};o=t.extend(o,c.moduleConfig),a.forEach(e.sureDataCont,function(n,i){u[i]=t.extend(!0,{},o),u[i].productNum=e.sureDataCont[i]}),a.forEach(e.productNumCont,function(n,i){u[i]=t.extend(!0,{},o),u[i].productNum=e.productNumCont[i]}),a.forEach(e.productionSeqNumCont,function(t,n){u[n].productionSeqNum=e.productionSeqNumCont[n]}),n=(0,i.default)(u),s.service("GMES-CLIENT-PCS0013",{subassemblyOnlinesJson:n},"正在确认...").done(function(){e.initData(!0)})}}})},changePageRender:function(e){this.changePage(e),this.getDataAndRender()},getDataAndRender:function(){var e,n=this;c.config.nowPage>=0?(e=c.config.urlDetail,this.queueType="productionQueues"):(e=c.config.urlHistory,this.queueType="subassemblyOnlineDTOs");var u={stationCode:"",pageNum:c.config.nowPage,getNum:c.config.pageSize,siteCode:c.config.siteCode,rowNum:10,stNum:2,num:c.moduleConfig.rowNum};u=t.extend(u,c.moduleConfig),s.service(e,u,"正在加载中").done(function(e){n.ajaxSucc(e)})},ajaxSucc:function(e){var t=this;a.triggerSuccessEvun({response:e,haveData:function(e){t.emptySureData(),t.render(e,!0)},noData:function(){u.alert({type:1,text:"无数据 "+e.errorMessage}),t.render(t.data)}})},render:function(e,n){var u=e[this.queueType],o=this;!0===n&&this.totalHistoryRender(e.dln-1,-e.lsn),u.length<2&&(0===u.length&&t(".u-queuingSure").addClass("u-queue-disabled"),u.push(o.data[this.queueType]),u.length<2&&u.push(o.data[this.queueType])),a.forEach(u,function(e,t){o.sureDataCont.push(u[t].productNum),o.productNumCont.push(u[t].productNum),o.productionSeqNumCont.push(u[t].productId)}),a.forEach(u,function(e,t){u[t]=s.processData(c.moduleConfig,u[t])}),c.config.ifReverse&&u.reverse(),s.tplManager("queuingDoubleTpl",u[0],"leftQueue"),s.tplManager("queuingDoubleTpl",u[1],"rightQueue")},totalHistoryRender:function(e,n){e<0&&(e=0),t(".u-queue-total").html(e),t(".u-queue-history").html(n)}};e.exports=g}).call(t,n(4),n(36))}});
//# sourceMappingURL=pcs_queuingDoubleIndication_ba49ca072141a3a53045.js.map