webpackJsonp([37],{618:function(e,t,n){"use strict";(function(e,t){var n={timer:null,init:function(){util.setBreadcrumb(["质量Andon"]),this.loadPage()},event:function(){var n=this;e.each(e("a[type='andon']"),function(t,n){var a=e(n);2==a.attr("statusECode")?(a.attr("statusECode"),Number(a.attr("touchTimeLong"))<=1e4&&a.css("background","#FFFF00"),Number(a.attr("touchTimeLong"))>1e4&&a.css("background","#FF0000")):(a.css("background","#00FF00"),a.attr("statusECode"))}),e("a[type='andon']").on("click",function(a){var o=n,r=e(a.target);"A"!=a.target.tagName&&(r=r.parents("a")),t.request({url:"restful/service/execute",type:"POST",data:{serviceCode:"ANDON.UPDATE",siteCode:t.siteCode,andonCode:r.attr("andonCode"),workUnitCode:r.attr("workUnitCode"),modifyUser:r.attr("modifyUser")},success:function(e){2==r.attr("statusECode")?(r.css("background","#00FF00"),r.attr("statusECode",1),r.attr("touchTimeLong",0),r.find(".touch-time").text("")):(o.calTime(new Date),r.css("background","#FFFF00"),r.attr("statusECode",2))},error:function(){myApp.alert("语言列表加载失败")}})}),this.timer||(this.timer=setInterval(function(){e("a[type='andon']").each(function(t){var a=e(this);if(2==a.attr("statusECode")){var o=a.attr("touchTimeLong"),r=Number(o)+1e3;a.attr("touchTimeLong",r).find(".touch-time").text(n.calTime2(r)),r<=1e4&&a.css("background","#FFFF00"),r>1e4&&a.css("background","#FF0000")}})},1e3))},loadPage:function(n){var a=this;t.request({url:"restful/service/execute",type:"POST",data:{serviceCode:"ANDON.LIST",siteCode:"1310",workUnitCode:"SSSS",andonTypeCode:""},success:function(n){var o=e.parseJSON(n.data).data,r=a.group(o,6);t.tplManager("andonSwiperTpl",r,"andonSwiperRender");myApp.swiper("#andonSwiper",{pagination:"#andonSwiperPg"});a.event()},error:function(){alert("error")}})},render:function(e){},group:function(e,t){for(var n=0,a={newAndons:[]};n<e.length;)a.newAndons.push(e.slice(n,n+=t));return a},calTime:function(e){var t=e,n=new Date,a=n.getTime()-t.getTime(),o=Math.floor(a/864e5),r=a%864e5,i=Math.floor(r/36e5),s=r%36e5,u=Math.floor(s/6e4),c=s%6e4;return o+"天 "+i+"小时 "+u+" 分钟"+Math.round(c/1e3)+" 秒"},calTime2:function(e){var t=Math.floor(e/864e5);0!=t?t+="天":t="";var n=e%864e5,a=Math.floor(n/36e5);0!=a?a+="小时":a="";var o=n%36e5,r=Math.floor(o/6e4);0!=r?r+="分钟":r="";var i=o%6e4,s=Math.round(i/1e3);return 0!=s?s+="秒":s="",t+a+r+s}};myApp.onPageInit("andonIndex",function(t){e(document).off("keydown"),n.init()})}).call(t,n(4),n(77))}});
//# sourceMappingURL=andon_andonIndex_c7e5e92a5cf3c972a7f8.js.map