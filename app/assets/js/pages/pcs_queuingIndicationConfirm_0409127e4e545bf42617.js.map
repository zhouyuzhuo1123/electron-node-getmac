{"version":3,"sources":["webpack:///assets/js/pages/pcs_queuingIndicationConfirm_0409127e4e545bf42617.js","webpack:///./src/js/pages/pcs/queuingIndicationConfirm.js"],"names":["webpackJsonp","637","module","exports","__webpack_require__","$","notie","setOptions","moduleConfig","options","configCodes","pictureConfigCode","rowNum","stationCode","title","renderConfig","pageNum","getNum","stNum","num","renderHisConfig","verifyConfig","productTrackNum","productNum","productNumCheckCode","productionSeqNum","DEFAULT","urlDetail","urlHistory","urlJump","total","_stringify","_stringify2","obj","__esModule","default","kit","util","security","queuingIndicationConfirmCtrl","init","_this","this","getSysModuleConfig","done","response","proConfig","focus","translate","page","render","type","history","detail","event","processData","list","data","productionQueues","getUrl","getParam","getPage","callback","html","productNumFormat","productIdFormat","carDescription","tplManager","service","View","initialize","current","events",".u-input",".confirmBtn","eventsFunction","verify","value","target","keyCode","text","alert","select","ext","productId","arr","extend","subassemblyOnlinesJson","confirm","call"],"mappings":"AAAAA,cAAc,KAERC,IACA,SAAUC,EAAQC,EAASC,GAEjC,cAC4B,SAASC,EAAGC,GCaxC,QAASC,GAAWC,GACnBC,GAECD,aAAcA,IACbE,eACAC,kBAAmB,GACnBC,OAAQ,GACRC,YAAa,GACbC,MAAO,IAGRC,cACCF,YAAaL,EAAaK,YAC1BG,QAAS,EACTC,OAAQ,EACRC,MAAO,EACPC,IAAKX,EAAaI,QAGnBQ,iBACCP,YAAaL,EAAaK,YAC1BG,SAAU,EACVC,OAAQ,EACRC,MAAO,EACPC,IAAKX,EAAaI,QAGnBS,cACCR,YAAaL,EAAaK,YAC1BS,gBAAiB,IACjBC,WAAY,GACZC,oBAAqB,GACrBC,iBAAkB,IAGnBC,SACCC,UAAW,sBACXC,WAAY,sBACZC,QAAS,uBAEVC,UDnDF,GAAIC,GAAa3B,EAAoB,IAEjC4B,EAEJ,SAAgCC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,IAF9CF,GCDrCK,EAAMhC,EAAQ,IACdiC,EAAOjC,EAAQ,IACfkC,EAAWlC,EAAQ,IAMnBK,EAAU,KA8CV8B,GACHC,KAAM,WACL,GAAIC,GAAQC,IAEZJ,GAASK,mBAAmB,MAAO,8BAEjCC,KAAK,SAAUC,GAEfR,EAAKS,UAAUD,EAAU,SAASrC,GAGjCD,EAAWC,GAEXiC,EAAMM,QACNV,EAAKW,UAAUP,EAAMQ,MAErBR,EAAMS,OAAOT,EAAMU,KAAKC,SACxBX,EAAMS,OAAOT,EAAMU,KAAKE,QACxBZ,EAAMa,aAIVP,MAAO,WACN1C,EAAE,YAAY0C,SAGfQ,YAAa,SAAUV,GAGtB,GAAIW,GAAOX,EAASY,KAAKC,kBAAoBb,EAASY,KAAT,0BACzCA,EAAOD,EAAK,MAIhB,OAFA/C,GAAQqB,MAAQ2B,EAAOpB,EAAKkB,YAAY9C,EAAQD,aAAciD,GAEvDA,GAERN,MACCC,SACCO,OAAQ,WACP,MAAOlD,GAAQiB,QAAQE,YAExBgC,SAAU,WACT,MAAOnD,GAAQW,iBAEhByC,QAAS,WACR,OAAQ,GAETC,SAAU,SAAUL,GAGnBpD,EAAE,oBAAoB0D,KAAKN,EAAKO,kBAChC3D,EAAE,mBAAmB0D,KAAKN,EAAKQ,iBAC/B5D,EAAE,wBAAwB0D,KAAKN,EAAKS,kBAGtCb,QACCM,OAAQ,WACP,MAAOlD,GAAQiB,QAAQC,WAExBiC,SAAU,WACT,MAAOnD,GAAQM,cAEhB8C,QAAS,WACR,MAAOpD,GAAQM,aAAaC,SAE7B8C,SAAU,SAAUL,GAEnBhD,EAAQY,aAAaE,WAAakC,EAAKlC,WAGvCc,EAAK8B,WAAW,mBAAoBV,EAAM,yBAI7CP,OAAQ,SAAUC,GACjB,GAAIV,GAAQC,IAGZS,GAAKnC,QAAUmC,EAAKU,UAEpBxB,EAAK+B,QAAQjB,EAAKQ,SAAUR,EAAKS,WAAY,UAC5ChB,KAAK,SAAUC,GACf,GAAIY,GAAOhB,EAAMc,YAAYV,EAC7BM,GAAKW,SAASL,MAIhBH,MAAO,WACN,GAAIb,GAAQC,IACZ,IAAIN,GAAIiC,MACPC,WAAY,aAEZC,QAASlE,EAAE,6BACXmE,QACCC,WAAY,eACZC,cAAe,WAEhBC,gBACCC,OAAQ,SAAUtB,GACjB,GAAIuB,GAAQvB,EAAMwB,OAAOD,KACzB,IAAsB,KAAlBvB,EAAMyB,SAA4B,KAAVF,EAAc,CACzC,GAAIG,GAAOvE,EAAQY,aAAaE,UAChC,IAAa,OAATyD,GAA0B,KAATA,EAEpB,WADA1E,GAAM2E,OAAQD,KAAM,eAGrB3E,GAAEiD,EAAMwB,QAAQI,QAEhB,IAAIC,IACH3D,oBAAqBqD,EACrBvD,gBAAiB,IACjBG,iBAAkBhB,EAAQqB,MAAMsD,WAG7BC,GAAOhF,EAAEiF,OAAO7E,EAAQY,aAAc8D,IACtC1B,GAAS8B,wBAAwB,EAAAvD,EAAAG,SAAekD,GAEpDhD,GAAK+B,QAAQ3D,EAAQiB,QAAQG,QAAS4B,EAAM,QAC1Cb,KAAK,WAELtC,EAAM2E,OAAQD,KAAM,kBAAmB7B,KAAM,MAC7CV,EAAMM,QACNN,EAAMS,OAAOT,EAAMU,KAAKC,SAGxB3C,EAAQM,aAAaC,QAAU,EAC/ByB,EAAMS,OAAOT,EAAMU,KAAKE,YAI5BmC,QAAS,WACR/E,EAAQM,aAAaC,UACrByB,EAAMS,OAAOT,EAAMU,KAAKE,QACxBZ,EAAMM,aAOX7C,GAAOC,QAAUoC,IDrBYkD,KAAKtF,EAASC,EAAoB,GAAIA,EAAoB","file":"assets/js/pages/pcs_queuingIndicationConfirm_0409127e4e545bf42617.js","sourcesContent":["webpackJsonp([24],{\n\n/***/ 637:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($, notie) {\n\nvar _stringify = __webpack_require__(38);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar kit = __webpack_require__(78);\nvar util = __webpack_require__(34);\nvar security = __webpack_require__(35);\nvar productionQueues = \"subassemblyOnlineDTOs\";\n\nvar options = null;\n\nfunction setOptions(moduleConfig) {\n\toptions = {\n\t\tmoduleConfig: moduleConfig || {\n\t\t\tconfigCodes: [],\n\t\t\tpictureConfigCode: \"\",\n\t\t\trowNum: \"\",\n\t\t\tstationCode: \"\",\n\t\t\ttitle: \"\" },\n\n\t\trenderConfig: {\n\t\t\tstationCode: moduleConfig.stationCode,\n\t\t\tpageNum: 0,\n\t\t\tgetNum: 1,\n\t\t\tstNum: 2,\n\t\t\tnum: moduleConfig.rowNum },\n\n\t\trenderHisConfig: {\n\t\t\tstationCode: moduleConfig.stationCode,\n\t\t\tpageNum: -1,\n\t\t\tgetNum: 1,\n\t\t\tstNum: 2,\n\t\t\tnum: moduleConfig.rowNum },\n\n\t\tverifyConfig: {\n\t\t\tstationCode: moduleConfig.stationCode,\n\t\t\tproductTrackNum: \"1\",\n\t\t\tproductNum: \"\",\n\t\t\tproductNumCheckCode: \"\",\n\t\t\tproductionSeqNum: \"\" },\n\n\t\tDEFAULT: {\n\t\t\turlDetail: \"GMES-CLIENT-PCS0011\",\n\t\t\turlHistory: \"GMES-CLIENT-PCS0012\",\n\t\t\turlJump: \"GMES-CLIENT-PCS0014\" },\n\t\ttotal: {} };\n}\n\nvar queuingIndicationConfirmCtrl = {\n\tinit: function init() {\n\t\tvar _this = this;\n\n\t\tsecurity.getSysModuleConfig(\"PCS\", \"QUEUING_INDICATION_CONFIRM\").done(function (response) {\n\n\t\t\tutil.proConfig(response, function (moduleConfig) {\n\t\t\t\tsetOptions(moduleConfig);\n\n\t\t\t\t_this.focus();\n\t\t\t\tutil.translate(_this.page);\n\n\t\t\t\t_this.render(_this.type.history);\n\t\t\t\t_this.render(_this.type.detail);\n\t\t\t\t_this.event();\n\t\t\t});\n\t\t});\n\t},\n\tfocus: function focus() {\n\t\t$(\".u-input\").focus();\n\t},\n\n\tprocessData: function processData(response) {\n\t\tvar list = response.data.productionQueues || response.data[productionQueues] || [];\n\t\tvar data = list[0] || {};\n\n\t\toptions.total = data = util.processData(options.moduleConfig, data);\n\n\t\treturn data;\n\t},\n\ttype: {\n\t\thistory: {\n\t\t\tgetUrl: function getUrl() {\n\t\t\t\treturn options.DEFAULT.urlHistory;\n\t\t\t},\n\t\t\tgetParam: function getParam() {\n\t\t\t\treturn options.renderHisConfig;\n\t\t\t},\n\t\t\tgetPage: function getPage() {\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\tcallback: function callback(data) {\n\t\t\t\t$(\".top .productNum\").html(data.productNumFormat);\n\t\t\t\t$(\".top .productId\").html(data.productIdFormat);\n\t\t\t\t$(\".top .carDescription\").html(data.carDescription);\n\t\t\t}\n\t\t},\n\t\tdetail: {\n\t\t\tgetUrl: function getUrl() {\n\t\t\t\treturn options.DEFAULT.urlDetail;\n\t\t\t},\n\t\t\tgetParam: function getParam() {\n\t\t\t\treturn options.renderConfig;\n\t\t\t},\n\t\t\tgetPage: function getPage() {\n\t\t\t\treturn options.renderConfig.pageNum;\n\t\t\t},\n\t\t\tcallback: function callback(data) {\n\t\t\t\toptions.verifyConfig.productNum = data.productNum;\n\n\t\t\t\tutil.tplManager(\"ConfirmRenderTpl\", data, \"ConfirmRenderTotal\");\n\t\t\t}\n\t\t}\n\t},\n\trender: function render(type) {\n\t\tvar _this = this;\n\n\t\ttype.pageNum = type.getPage();\n\n\t\tutil.service(type.getUrl(), type.getParam(), \"正在加载数据\").done(function (response) {\n\t\t\tvar data = _this.processData(response);\n\t\t\ttype.callback(data);\n\t\t});\n\t},\n\n\tevent: function event() {\n\t\tvar _this = this;\n\t\tnew kit.View({\n\t\t\tinitialize: function initialize() {},\n\t\t\tcurrent: $(\"#queuingIndicationConfirm\"),\n\t\t\tevents: {\n\t\t\t\t\".u-input\": \"keyup verify\",\n\t\t\t\t\".confirmBtn\": \"confirm\" },\n\t\t\teventsFunction: {\n\t\t\t\tverify: function verify(event) {\n\t\t\t\t\tvar value = event.target.value;\n\t\t\t\t\tif (event.keyCode === 13 && value !== \"\") {\n\t\t\t\t\t\tvar text = options.verifyConfig.productNum;\n\t\t\t\t\t\tif (text === \"--\" || text === \"\") {\n\t\t\t\t\t\t\tnotie.alert({ text: \"当前校验对象无有效字段\" });\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(event.target).select();\n\n\t\t\t\t\t\tvar ext = {\n\t\t\t\t\t\t\tproductNumCheckCode: value,\n\t\t\t\t\t\t\tproductTrackNum: \"1\",\n\t\t\t\t\t\t\tproductionSeqNum: options.total.productId };\n\n\t\t\t\t\t\tvar arr = [$.extend(options.verifyConfig, ext)];\n\t\t\t\t\t\tvar data = { subassemblyOnlinesJson: (0, _stringify2.default)(arr) };\n\n\t\t\t\t\t\tutil.service(options.DEFAULT.urlJump, data, \"正在验证\").done(function () {\n\n\t\t\t\t\t\t\tnotie.alert({ text: \"检验通过，产品分装上线记录成功\", type: \"1\" });\n\t\t\t\t\t\t\t_this.focus();\n\t\t\t\t\t\t\t_this.render(_this.type.history);\n\n\t\t\t\t\t\t\toptions.renderConfig.pageNum = 0;\n\t\t\t\t\t\t\t_this.render(_this.type.detail);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tconfirm: function confirm() {\n\t\t\t\t\toptions.renderConfig.pageNum++;\n\t\t\t\t\t_this.render(_this.type.detail);\n\t\t\t\t\t_this.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n\nmodule.exports = queuingIndicationConfirmCtrl;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(4), __webpack_require__(36)))\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// assets/js/pages/pcs_queuingIndicationConfirm_0409127e4e545bf42617.js","/*\r\n * @name: pages\\pcs\\queuingIndicationConfirm.js\r\n * @author: EVUN前端组\r\n * @modify: kelichao \r\n * @update: 2017-07-20\r\n * @decript: 上件指示（防错版）\r\n * @url: http://git.evun.cn/GMES/GMES_CLIENT_PAD\r\n */\r\n\r\nvar kit = require(\"kit\");\r\nvar util = require(\"util\");\r\nvar security = require(\"security\");// 用于获取请求参数的封装体\r\n\r\n// 键值消歧\r\nvar productionQueues = \"subassemblyOnlineDTOs\";\r\n\r\n// 配置项\r\nvar options = null;\r\n\r\nfunction setOptions(moduleConfig) {\r\n\toptions = {\r\n\t\t// 模块站点配置, ajax参数\r\n\t\tmoduleConfig: moduleConfig || {\r\n\t\t\tconfigCodes: [],// 配置代码\"ZYB\"\r\n\t\t\tpictureConfigCode: \"\",// 图片配置代码\r\n\t\t\trowNum: \"\",// 队列长度\r\n\t\t\tstationCode: \"\",// 站点代码\r\n\t\t\ttitle: \"\"// 仪表上件指示\r\n\t\t},\r\n\t\t// 渲染ajax额外参数\r\n\t\trenderConfig: {\r\n\t\t\tstationCode: moduleConfig.stationCode,\r\n\t\t\tpageNum: 0,// 当前页码\r\n\t\t\tgetNum: 1,// 每页数量\r\n\t\t\tstNum: 2,// 新增参数 初始位置\r\n\t\t\tnum: moduleConfig.rowNum,// 列队最大数量,其实就是(rowNum)\r\n\t\t},\r\n\t\t// 渲染历史记录额外参数\r\n\t\trenderHisConfig: {\r\n\t\t\tstationCode: moduleConfig.stationCode,\r\n\t\t\tpageNum: -1,// 当前页码\r\n\t\t\tgetNum: 1,// 每页数量\r\n\t\t\tstNum: 2,// 新增参数 初始位置\r\n\t\t\tnum: moduleConfig.rowNum,// 列队最大数量,其实就是(rowNum)\r\n\t\t},\r\n\t\t// 验证ajax额外参数\r\n\t\tverifyConfig: {\r\n\t\t\tstationCode: moduleConfig.stationCode,// 站点代码\r\n\t\t\tproductTrackNum: \"1\",//产品跟踪号，先空\r\n\t\t\tproductNum: \"\",// 产品标识号\r\n\t\t\tproductNumCheckCode: \"\",// 输入的数据\r\n\t\t\tproductionSeqNum: \"\"// productId\r\n\t\t},\r\n\t\t// 常量\r\n\t\tDEFAULT: {\r\n\t\t\turlDetail: \"GMES-CLIENT-PCS0011\",// 当前列队标识\r\n\t\t\turlHistory: \"GMES-CLIENT-PCS0012\",// 历史标识\r\n\t\t\turlJump: \"GMES-CLIENT-PCS0014\"// 确认按钮\r\n\t\t},\r\n\t\ttotal: {}// 存放当前渲染数据\r\n\t};\r\n}\r\n\r\nvar queuingIndicationConfirmCtrl = {\r\n\tinit: function () {\r\n\t\tvar _this = this;\r\n\r\n\t\tsecurity.getSysModuleConfig(\"PCS\", \"QUEUING_INDICATION_CONFIRM\")\r\n\r\n\t\t\t.done(function (response) {\r\n\r\n\t\t\t\tutil.proConfig(response, function(moduleConfig) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 获取模块配置,及参数初始化\r\n\t\t\t\t\tsetOptions(moduleConfig);\r\n\r\n\t\t\t\t\t_this.focus();\r\n\t\t\t\t\tutil.translate(_this.page);\r\n\r\n\t\t\t\t\t_this.render(_this.type.history);\r\n\t\t\t\t\t_this.render(_this.type.detail);\r\n\t\t\t\t\t_this.event();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t},\r\n\tfocus: function () {\r\n\t\t$(\".u-input\").focus();\r\n\t},\r\n\t// 处理数据\r\n\tprocessData: function (response) {\r\n\r\n\t\t// 消歧\r\n\t\tvar list = response.data.productionQueues || response.data[productionQueues] || [];\r\n\t\tvar data = list[0] || {};\r\n\r\n\t\toptions.total = data = util.processData(options.moduleConfig, data);\r\n\r\n\t\treturn data;\r\n\t},\r\n\ttype: {\r\n\t\thistory: {\r\n\t\t\tgetUrl: function() {\r\n\t\t\t\treturn options.DEFAULT.urlHistory;\r\n\t\t\t},\r\n\t\t\tgetParam: function() {\r\n\t\t\t\treturn options.renderHisConfig;\r\n\t\t\t},\r\n\t\t\tgetPage: function() {\r\n\t\t\t\treturn -1;\r\n\t\t\t},\r\n\t\t\tcallback: function (data) {\r\n\r\n\t\t\t\t// 渲染历史\r\n\t\t\t\t$(\".top .productNum\").html(data.productNumFormat);\r\n\t\t\t\t$(\".top .productId\").html(data.productIdFormat);\r\n\t\t\t\t$(\".top .carDescription\").html(data.carDescription);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdetail: {\r\n\t\t\tgetUrl: function() {\r\n\t\t\t\treturn options.DEFAULT.urlDetail;\r\n\t\t\t},\r\n\t\t\tgetParam: function() {\r\n\t\t\t\treturn options.renderConfig;\r\n\t\t\t},\r\n\t\t\tgetPage: function() {\r\n\t\t\t\treturn options.renderConfig.pageNum;\r\n\t\t\t},\r\n\t\t\tcallback: function (data) {\r\n\t\t\t\t// 设置需要校验的vin号\r\n\t\t\t\toptions.verifyConfig.productNum = data.productNum;\r\n\r\n\t\t\t\t// 渲染当前列队\r\n\t\t\t\tutil.tplManager(\"ConfirmRenderTpl\", data, \"ConfirmRenderTotal\");\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trender: function (type) {\r\n\t\tvar _this = this;\r\n\r\n\t\t// 设置页码\r\n\t\ttype.pageNum = type.getPage();\r\n\r\n\t\tutil.service(type.getUrl(), type.getParam(), \"正在加载数据\")\r\n\t\t.done(function (response) {\r\n\t\t\tvar data = _this.processData(response);\r\n\t\t\ttype.callback(data);\r\n\t\t});\r\n\t},\r\n\t// 事件处理\r\n\tevent: function () {\r\n\t\tvar _this = this;\r\n\t\tnew kit.View({\r\n\t\t\tinitialize: function () {\r\n\t\t\t},\r\n\t\t\tcurrent: $(\"#queuingIndicationConfirm\"),\r\n\t\t\tevents: {\r\n\t\t\t\t\".u-input\": \"keyup verify\",// 回车验证\r\n\t\t\t\t\".confirmBtn\": \"confirm\"// 跳过异常\r\n\t\t\t},\r\n\t\t\teventsFunction: {\r\n\t\t\t\tverify: function (event) {\r\n\t\t\t\t\tvar value = event.target.value;\r\n\t\t\t\t\tif (event.keyCode === 13 && value !== \"\") {// 回车键\r\n\t\t\t\t\t\tvar text = options.verifyConfig.productNum;\r\n\t\t\t\t\t\tif (text === \"--\" || text === \"\") {\r\n\t\t\t\t\t\t\tnotie.alert({ text: \"当前校验对象无有效字段\" });\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$(event.target).select();\r\n\r\n\t\t\t\t\t\tvar ext = {\r\n\t\t\t\t\t\t\tproductNumCheckCode: value,// 输入的数据\r\n\t\t\t\t\t\t\tproductTrackNum: \"1\",// 产品跟踪号，先空\r\n\t\t\t\t\t\t\tproductionSeqNum: options.total.productId// productId\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tvar arr = [$.extend(options.verifyConfig, ext)];\r\n\t\t\t\t\t\tvar data = { subassemblyOnlinesJson: JSON.stringify(arr) };\r\n\r\n\t\t\t\t\t\tutil.service(options.DEFAULT.urlJump, data, \"正在验证\")\r\n\t\t\t\t\t\t\t.done(function () {\r\n\r\n\t\t\t\t\t\t\t\tnotie.alert({ text: \"检验通过，产品分装上线记录成功\", type: \"1\" });\r\n\t\t\t\t\t\t\t\t_this.focus();\r\n\t\t\t\t\t\t\t\t_this.render(_this.type.history);\r\n\r\n\t\t\t\t\t\t\t\t// 初始化页面\r\n\t\t\t\t\t\t\t\toptions.renderConfig.pageNum = 0;\r\n\t\t\t\t\t\t\t\t_this.render(_this.type.detail);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tconfirm: function () {\r\n\t\t\t\t\toptions.renderConfig.pageNum ++;\r\n\t\t\t\t\t_this.render(_this.type.detail);\r\n\t\t\t\t\t_this.focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n};\r\n\r\nmodule.exports = queuingIndicationConfirmCtrl;\n\n\n// WEBPACK FOOTER //\n// ./src/js/pages/pcs/queuingIndicationConfirm.js"],"sourceRoot":""}